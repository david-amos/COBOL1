Variable Declarations
AlfaNumeric: I-GUEST, I-CONDO, I-PETS, I-HOTTUB, O-GUEST, O-CONDO, O-PETS, O-HOTTUB, O-BEDROOMS, O-NIGHTS, O-DOCKSLIP,
			O-NIGHTLY-FEE, O-CLEANING-FEE, O-CONDO-FEE, O-SUBTOTAL, O-DEAL-AMOUNT, O-AMOUNT-DUE
			O-GT-SUBTOTAL, O-GT-DEAL-AMOUNT, O-GT-AMOUNT-DUE, O-RENTAL-CTR, O-FREE-NIGHTS, O-FREE-CLEANING, O-PET-FEES, O-HOTTUB-FEES
			EOF, O-DATE, O-PCTR, FLAG = '', O-MONTH
Numberic: I-BEDROOMS, I-NIGHTS, I-DOCKSLIP, C-NIGHTLY-FEE, C-CLEANING-FEE, C-CONDO-FEE, C-DOCKSLIP-FEE, C-SUBTOTAL, C-DEAL-AMOUNT, C-AMOUNT-DUE
			C-GT-SUBTOTAL = 0, C-GT-DEAL-AMOUNT = 0, C-GT-AMOUNT-DUE = 0, C-RENTAL-CTR = 0, C-FREE-NIGHTS = 0, C-FREE-CLEANING = 0, C-PET-FEES = 0, C-HOTTUB-FEES = 0,
			C-DATE, C-PCTR = 0, TODAY, C-MONTH
			
0000-MAIN
	CALL 1000-INIT
	CALL 2000-MAINLINE
		WHILE EOF = FALSE
	CALL 3000-CLOSING
	
1000-INIT
	OPEN INPUT FILE
	OPEN OUTPUT FILE
	REQUEST DATE
	GET C-DATE
	MOVE C-DATE TO O-DATE
	PERFORM 9000-READ
	PERFORM 9100-HEADINGS
	
2000-MAINLINE
	CALL 2100-CALCS
	CALL 2200-OUTPUT
	CALL 9000-READ
	
2100-CALCS
	C-DEAL-AMOUNT = 0
	MOVE '' TO FLAG
	EVALUATE CONDO
		WHEN 'HB'
			CALL 2110-HORSE
		WHEN 'OB'
			CALL 2120-BEACH
		WHEN 'PP'
			CALL 2130-PISTOL
		WHEN 'RB'
			CALL 2140-BAY
		WHEN 'SB'
			CALL 2150-SHAWNEE
		WHEN 'L'
			CALL 2160-LEDGES
		WHEN 'HT'
			CALL 2170-HARBOUR
		WHEN 'CP'
			CALL 2180-COMPASSE.
			
	C-DOCKSLIP-FEE = I-DOCKSLIP * I-NIGHTS
	C-SUBTOTAL = C-CONDO-FEE + C-CLEANING-FEE + C-DOCKSLIP-FEE
	C-AMOUNT-DUE = C-SUBTOTAL + C-DEAL-AMOUNT
	
	C-RENTAL-CTR += 1
	C-GT-SUBTOTAL += C-SUBTOTAL
	C-GT-DEAL-AMOUNT += C-DEAL-AMOUNT
	
2110-HORSE
	C-NIGHTLY-FEE = 99.50 * I-BEDROOMS
	C-CLEANING-FEE = 100
	C-CONDO-FEE = C-NIGHTLY-FEE * I-NIGHTS
	IF I-HOTTUB = 'Y'
		C-DEAL-AMOUNT = C-CONDO-FEE * .05
		C-HOTTUB-FEES += C-CONDO-FEE * .05
	IF I-PETS = 'Y'
		C-DEAL-AMOUNT += C-CONDO-FEE * .1
		C-PET-FEES += C-CONDO-FEE * .1
2120-BEACH
	C-NIGHTLY-FEE = 188 * I-BEDROOMS
	C-CLEANING-FEE = 150
	C-CONDO-FEE = C-NIGHTLY-FEE * I-NIGHTS
	IF I-NIGHTS >= 7
		C-DEAL-AMOUNT = -1 * C-NIGHTLY-FEE
		C-FREE-NIGHTS += 1
	IF I-PETS = 'Y'
		C-DEAL-AMOUNT += C-CONDO-FEE * .1
		C-PET-FEES += C-CONDO-FEE * .1
	
2130-PISTOL
	C-NIGHTLY-FEE = 50 * I-BEDROOMS
	C-CLEANING-FEE = 75
	C-CONDO-FEE = C-NIGHTLY-FEE * I-NIGHTS
	
	
2140-BAY
	C-NIGHTLY-FEE = 62.1 * I-BEDROOMS
	C-CLEANING-FEE = 75
	C-CONDO-FEE = C-NIGHTLY-FEE * I-NIGHTS
	IF I-NIGHTS > 5 
		C-DEAL-AMOUNT = -75
		C-FREE-CLEANING += 1
		
2150-SHAWNEE
	C-NIGHTLY-FEE = 100 * I-BEDROOMS
	C-CLEANING-FEE = 150
	C-CONDO-FEE = C-NIGHTLY-FEE * I-NIGHTS
	IF I-PETS = 'Y'
		C-DEAL-AMOUNT = .1 * C-CONDO-FEE
		C-PET-FEES += .1 * C-CONDO-FEE
	
2160-LEDGES
	C-NIGHTLY-FEE = 76.35 * I-BEDROOMS
	C-CLEANING-FEE = 0
	C-CONDO-FEE = C-NIGHTLY-FEE * I-NIGHTS
	IF I-HOTTUB = 'Y'
		C-DEAL-AMOUNT = .075 * C-CONDO-FEE
		C-HOTTUB-FEES += .075 * C-CONDO-FEE
	
2170-HARBOUR
	C-NIGHTLY-FEE = 50 * I-BEDROOMS
	C-CLEANING-FEE = 100
	C-CONDO-FEE = C-NIGHTLY-FEE * I-NIGHTS
	IF I-NIGHTS >= 3
		C-DEAL-AMOUNT = -.5 * C-NIGHTLY-FEE
		C-FREE-NIGHTS += .5
		
2180-COMPASSE
	C-NIGHTLY-FEE = 125 * I-BEDROOMS
	C-CLEANING-FEE = 0
	C-CONDO-FEE = C-NIGHTLY-FEE * I-NIGHTS
	IF I-NIGHTS >= 5
		C-DEAL-AMOUNT = -1 * C-NIGHTLY-FEE
		C-FREE-NIGHTS += 1
		
2200-OUTPUT
	MOVE I-NIGHTS TO O-NIGHTS
	MOVE C-NIGHTLY-FEE TO O-NIGHTLY-FEE
	MOVE C-CONDO-FEE TO O-CONDO-FEE
	MOVE C-CLEANING-FEE TO O-CLEANING-FEE
	MOVE C-DOCKSLIP-FEE TO O-DOCKSLIP
	MOVE C-SUBTOTAL TO O-SUBTOTAL
	MOVE C-DEAL-AMOUNT TO O-DEAL-AMOUNT
	MOVE C-AMOUNT-DUE TO O-AMOUNT-DUE
	IF C-AMOUNT-DUE > 750
		MOVE '****' TO FLAG
	PRINT DETAIL LINE 
	
3000-CLOSING
	PRINT BLANK-LINE
	PRINT BLANK-LINE
	MOVE C-GT-SUBTOTAL TO O-GT-SUBTOTAL
	MOVE C-GT-DEAL-AMOUNT TO O-GT-DEAL-AMOUNT
	MOVE C-GT-AMOUNT-DUE TO O-GT-AMOUNT-DUE
	MOVE C-RENTAL-CTR TO O-RENTAL-CTR
	MOVE C-FREE-NIGHTS TO O-FREE-NIGHTS
	MOVE C-FREE-CLEANING TO O-FREE-CLEANING
	MOVE C-PET-FEES TO O-PET-FEES
	MOVE C-HOTTUB-FEES TO O-HOTTUB-FEES
	
	PRINT GT-LINE-1
	PRINT BLANK-LINE
	PRINT GT-LINE-2
	PRINT GT-LINE-3
	
	CLOSE INPUT FILE 
	CLOSE OUTPUT FILE
	IF END-OF-PAGE
		PERFORM 9100-HEADINGS
		
9000-READ
	READ RECORD
		IF EOF
			MORE-RECS = 'YES'
			
9100-HEADINGS
	C-PCTR +=1
	MOVE C-PCTR TO O-PCTR
	REQUEST SYSTEM DATE
	GET TODAY
	MOVE TODAY TO C-MONTH
	EVALUATE C-MONTH
		WHEN 01
			MOVE 'JANUARY' TO O-MONTH
		WHEN 02
			MOVE 'FEBRUARY' TO 0-MONTH
		WHEN 03
			MOVE 'MARCH' TO O-MONTH
		WHEN 04
			MOVE 'APRIL' TO O-MONTH
		WHEN 05
			MOVE 'MAY' TO O-MONTH
		WHEN 06
			MOVE 'JUNE' TO O-MONTH
		WHEN 07
			MOVE 'JULY' TO O-MONTH
		WHEN 08
			MOVE 'AUGUST' TO O-MONTH
		WHEN 09
			MOVE 'SEPTEMBER' TO O-MONTH
		WHEN 10
			MOVE 'OCTOBER' TO O-MONTH
		WHEN 11
			MOVE 'NOVEMBER' TO O-MONTH
		WHEN 12
			MOVE 'DECEMBER; TO O-MONTH
			
		PRINT COMPANY TITLE LINE
		PRINT REPORT TITLE LINE
		PRINT BLANK LINE
		PRINT COLLUMN HEADINGS 1
		PRINT COLLUMN HEADINGS 2
		PRINT BLANK LINE
		
	
	
	
	